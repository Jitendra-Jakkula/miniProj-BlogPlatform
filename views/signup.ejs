<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="/images/logo1.png" />
  <title>Scribo</title>
</head>

<body>
   <nav class="navbar navbar-expand-lg bg-white shadow-custom py-custom">
        <div class="container-fluid px-4 d-flex align-items-center justify-content-between">

            <!-- Left: Logo -->
             <a class="navbar-brand d-flex align-items-center ms-5 px-3" href="/posts">
                <img src="/images/logo3.png" alt="Logo" width="60" class="me-2">
                <!-- <span class="fw-bold text-primary">nameless</span> -->
            </a>

           
            <!-- Right: Auth Buttons -->
            <% if(!user){%>
                <div class="d-flex align-items-center gap-3">
                    <a href="/user/login" class="text-dark fw-medium text-decoration-none">Log in</a>
                    <!-- <a href="/user/signup" class="btn btn-primary px-4 py-1">Sign up</a> -->
                </div>
                <% } %>

        </div>
    </nav>
  <div class="container col-md-5 py-5">
    <h2 class="mb-4">Sign Up</h2>

    <!-- Flash Messages -->
    <% if (messages.success && messages.success.length > 0) { %>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <%= messages.success.join('<br>') %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>

    <% if (messages.error && messages.error.length > 0) { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <%= messages.error.join('<br>') %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>

    <form class="needs-validation" novalidate enctype="multipart/form-data" method="POST" action="/user/signup">

      <!-- Full Name -->
      <div class="mb-3">
        <label class="form-label">Full Name</label>
        <input type="text" class="form-control" name="fname" placeholder="Enter Full Name" required
               minlength="3" maxlength="50" pattern="^[a-zA-Z\s]+$">
        <div class="invalid-feedback">
          Please enter a valid full name (letters only, 3-50 chars).
        </div>
      </div>

      <!-- Email -->
      <div class="mb-3">
        <label class="form-label">Email address</label>
        <input type="email" class="form-control" name="email" placeholder="name@example.com" required
               pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
        <div class="invalid-feedback">
          Please provide a valid email.
        </div>
      </div>

      <!-- Username -->
      <div class="mb-3">
        <label class="form-label">Username</label>
        <input type="text" class="form-control" name="username" placeholder="Enter Username" required
               minlength="3" maxlength="20" pattern="^[a-zA-Z0-9_]+$">
        <div class="invalid-feedback">
          Username should be 3-20 characters and contain only letters, numbers, or underscores.
        </div>
      </div>

      <!-- Password -->
      <div class="mb-3">
        <label class="form-label">Password</label>
        <input type="password" class="form-control" name="password" placeholder="Enter Password" required
               minlength="6" maxlength="20" pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$">
        <div class="invalid-feedback">
          Password must be 6-20 characters, including at least one letter and one number.
        </div>
      </div>

      <!-- Profile Pic -->
      <div class="mb-3">
        <label class="form-label">Choose a Profile Picture</label>
        <input type="file" class="form-control" name="profilepic" accept="image/*">
      </div>

      <!-- Bio -->
      <div class="mb-4">
        <label class="form-label">About You</label>
        <textarea class="form-control" name="bio" rows="3" required minlength="10" maxlength="300"></textarea>
        <div class="invalid-feedback">
          Please write something about yourself (10-300 characters).
        </div>
      </div>

      <button type="submit" class="btn btn-success btn-lg">Sign Up</button>
    </form>
  </div>

  <script>
    // Bootstrap custom validation
    (function () {
      'use strict'
      const forms = document.querySelectorAll('.needs-validation')
      Array.from(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }
          form.classList.add('was-validated')
        }, false)
      })
    })()
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
